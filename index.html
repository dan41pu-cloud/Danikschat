<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Danikschat ‚Äî –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</title>
  <style>
    body { font-family: Inter, system-ui, sans-serif; background:#2f3136; color:#fff; margin:0; padding:20px; }
    .card { background:#36393f; padding:18px; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,0.35); width:90%; max-width:720px; margin:18px auto; display:flex; flex-direction:column; gap:10px; }
    h2 { margin:0 0 6px 0; font-size:20px; }
    input, select, button { padding:10px; border-radius:8px; border:none; box-sizing:border-box; width:100%; }
    button { background:#5865f2; color:#fff; cursor:pointer; }
    button.secondary { background:#4a4f55; }
    button.danger { background:#f04747; }
    .row { display:flex; gap:8px; }
    .row > * { flex:1; }
    ul { list-style:none; padding:0; margin:0; max-height:340px; overflow:auto; }
    li { margin:8px 0; padding:10px; background:#40444b; border-radius:10px; max-width:70%; width:fit-content; word-break:break-word; }
    .my { background:#7289da; margin-left:auto; }
    .meta { font-size:12px; color:#bdbfc6; margin-bottom:6px; }
    #emojiPicker { display:flex; gap:8px; }
    #emojiPicker button { width:auto; padding:6px 10px; font-size:18px; }
    #videoChat { display:none; flex-direction:column; gap:8px; }
    video { background:black; border-radius:8px; width:100%; height:240px; object-fit:cover; }
    .controls { display:flex; gap:8px; flex-wrap:wrap; }
    small.hint { color:#bdbfc6; }
    select option { padding:6px; }
  </style>
</head>
<body>

  <!-- –∑–≤—É–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –ø–æ–ª–æ–∂–∏—à—å —Ñ–∞–π–ª join.mp3 —Ä—è–¥–æ–º, –±—É–¥–µ—Ç –∑–≤—É–∫) -->
  <audio id="joinSound" src="join.mp3"></audio>

  <div id="auth" class="card">
    <h2>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
    <input id="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" autocomplete="username" />
    <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å" autocomplete="current-password" />
    <div class="row">
      <button id="login">–í–æ–π—Ç–∏</button>
      <button id="register" class="secondary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    </div>
    <p id="authMsg" class="meta"></p>
    <small class="hint">–ò–º—è –∏ –ø–∞—Ä–æ–ª—å —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ users.json (–ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –ø—Ä–æ–¥–µ –±–µ–∑ —Ö–µ—à–∞/–≤–∞–ª–∏–¥–∞—Ü–∏–∏).</small>
  </div>

  <div id="chat" class="card" style="display:none;">
    <h2 id="welcome">–ü—Ä–∏–≤–µ—Ç!</h2>

    <label for="userSelect">–°–æ–±–µ—Å–µ–¥–Ω–∏–∫ (–≤—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ):</label>
    <select id="userSelect">
      <option value="">-- –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è --</option>
    </select>

    <ul id="messages"></ul>

    <input id="input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." />
    <div class="row">
      <button id="send">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
      <input id="imageInput" type="file" accept="image/*" style="flex:0 0 120px;" />
    </div>

    <div id="emojiPicker">
      <button class="emoji">üòÄ</button>
      <button class="emoji">üòÇ</button>
      <button class="emoji">üòç</button>
      <button class="emoji">üòé</button>
      <button class="emoji">üëç</button>
    </div>

    <div class="row" style="margin-top:8px;">
      <button id="openVideoChat" class="">–í–∏–¥–µ–æ—á–∞—Ç</button>
      <button id="clearChat" class="secondary">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ</button>
    </div>
  </div>

  <div id="videoChat" class="card">
    <h3>–í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫ (–ø—Ä–∏–≤–∞—Ç–Ω–æ)</h3>
    <video id="localVideo" autoplay playsinline muted></video>
    <video id="remoteVideo" autoplay playsinline></video>

    <div class="controls">
      <button id="startVideo">–ù–∞—á–∞—Ç—å –≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫</button>
      <button id="stopVideo" class="danger">–ó–∞–∫–æ–Ω—á–∏—Ç—å –∑–≤–æ–Ω–æ–∫</button>
      <button id="toggleVideo" class="secondary">–í—ã–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É</button>
      <button id="toggleAudio" class="secondary">–í—ã–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω</button>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    // DOM
    const authDiv = document.getElementById('auth');
    const chatDiv = document.getElementById('chat');
    const usernameInput = document.getElementById('username');
    const passwordInput = document.getElementById('password');
    const authMsg = document.getElementById('authMsg');
    const welcome = document.getElementById('welcome');
    const userSelect = document.getElementById('userSelect');
    const messagesUL = document.getElementById('messages');
    const input = document.getElementById('input');
    const sendBtn = document.getElementById('send');
    const registerBtn = document.getElementById('register');
    const loginBtn = document.getElementById('login');
    const imageInput = document.getElementById('imageInput');
    const emojiButtons = document.querySelectorAll('.emoji');
    const openVideoChat = document.getElementById('openVideoChat');
    const videoChat = document.getElementById('videoChat');
    const startVideo = document.getElementById('startVideo');
    const stopVideo = document.getElementById('stopVideo');
    const localVideo = document.getElementById('localVideo');
    const remoteVideo = document.getElementById('remoteVideo');
    const toggleVideo = document.getElementById('toggleVideo');
    const toggleAudio = document.getElementById('toggleAudio');
    const clearChat = document.getElementById('clearChat');
    const joinSound = document.getElementById('joinSound');

    // State
    let username = null;
    let admin = false;
    let allUsers = [];     // –≤—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
    let onlineUsers = [];  // —Ç–µ–∫—É—â–∏–µ –æ–Ω–ª–∞–π–Ω
    let inCall = false;
    let localStream = null;
    let pc = null;
    let iceServers = null;
    let videoEnabled = true;
    let audioEnabled = true;

    // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è / –í—Ö–æ–¥
    registerBtn.onclick = () => {
      const u = usernameInput.value.trim();
      const p = passwordInput.value.trim();
      socket.emit('register', { username: u, password: p });
    };

    loginBtn.onclick = () => {
      const u = usernameInput.value.trim();
      const p = passwordInput.value.trim();
      socket.emit('login', { username: u, password: p });
    };

    socket.on('registerSuccess', msg => authMsg.textContent = msg);
    socket.on('registerError', msg => authMsg.textContent = msg);
    socket.on('loginError', msg => authMsg.textContent = msg);

    socket.on('loginSuccess', (data) => {
      username = data.username;
      admin = data.admin;

      authDiv.style.display = 'none';
      chatDiv.style.display = 'flex';
      welcome.textContent = `–ü—Ä–∏–≤–µ—Ç, ${username}!`;

      // –ø–æ–ª—É—á–∞–µ–º –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
      allUsers = Array.isArray(data.users) ? data.users.slice() : [];
      // —É–±–∏—Ä–∞–µ–º —Å–µ–±—è –∏–∑ –≤—ã–±–æ—Ä–∞
      populateUsers(allUsers.filter(u => u !== username), []);

      // –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—à–ª—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (—Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ —É—á–∞—Å—Ç–∏—é)
      if (Array.isArray(data.messages)) {
        data.messages.forEach(msg => {
          if (msg.from === username || msg.to === username) addMessage(msg);
        });
      }
    });

    // –°–µ—Ä–≤–µ—Ä –ø—Ä–∏—Å—ã–ª–∞–µ—Ç –∫—Ç–æ —Å–µ–π—á–∞—Å –æ–Ω–ª–∞–π–Ω
    socket.on('active-users', (list) => {
      onlineUsers = Array.isArray(list) ? list.slice() : [];
      // –æ–±–Ω–æ–≤–∏–º —Å–ø–∏—Å–æ–∫ (–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â–∏–π allUsers; –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç ‚Äî –∑–∞–ø—Ä–æ—Å–∏–º —Å–µ—Ä–≤–µ—Ä)
      if (!allUsers.length) {
        // –µ—Å–ª–∏ –µ—â—ë –Ω–µ –±—ã–ª–æ –ª–æ–≥–∏–Ω–∞/—Å–ø–∏—Å–∫–∞ ‚Äî –æ—Å—Ç–∞–≤–∏–º —Ç–æ–ª—å–∫–æ –æ–Ω–ª–∞–π–Ω
        populateUsers(onlineUsers.filter(u => u !== username), onlineUsers);
      } else {
        populateUsers(allUsers.filter(u => u !== username), onlineUsers);
      }
    });

    // –°–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–∞ (–≤–∫–ª—é—á–∞—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞–º–∏ –∏ –ø—Ä–∏—à–µ–¥—à–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)
    socket.on('private-message', (msg) => {
      // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –º—ã ‚Äî —É—á–∞—Å—Ç–Ω–∏–∫
      if (msg.from === username || msg.to === username) addMessage(msg);
    });

    // –ó–≤—É–∫ –≤—Ö–æ–¥—è—â–µ–≥–æ –≤—ã–∑–æ–≤–∞ (–µ—Å–ª–∏ –Ω–µ –≤ –∑–≤–æ–Ω–∫–µ)
    socket.on('audio-join', ({ from }) => {
      if (!inCall) {
        try { joinSound.currentTime = 0; joinSound.play().catch(()=>{}); } catch(e) {}
      }
    });

    // –í–µ–±—Ä—Ç–∫ –æ—Ñ—Ñ–µ—Ä –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
    socket.on('webrtc-offer', async (payload) => {
      // payload: { from, to, offer }
      try {
        if (payload.to !== username) return;
        inCall = true;

        // –ø–æ–ª—É—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ (–µ—Å–ª–∏ –µ—â—ë –Ω–µ—Ç)
        if (!localStream) {
          localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
          localVideo.srcObject = localStream;
        }

        pc = await createPeerConnection(payload.from);

        // –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–π–∫–∏
        localStream.getTracks().forEach(track => pc.addTrack(track, localStream));

        await pc.setRemoteDescription(new RTCSessionDescription(payload.offer));
        const answer = await pc.createAnswer();
        await pc.setLocalDescription(answer);

        // –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç
        socket.emit('webrtc-answer', { to: payload.from, answer });

        videoChat.style.display = 'flex';
        videoEnabled = true; audioEnabled = true;
        toggleVideo.textContent = "–í—ã–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É";
        toggleAudio.textContent = "–í—ã–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω";
      } catch (err) {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏—ë–º–µ –æ—Ñ—Ñ–µ—Ä–∞:", err);
      }
    });

    socket.on('webrtc-answer', async (payload) => {
      // payload: { from, to, answer }
      try {
        if (payload.to !== username) return;
        if (pc) {
          await pc.setRemoteDescription(new RTCSessionDescription(payload.answer));
        }
      } catch (err) {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ answer:", err);
      }
    });

    socket.on('webrtc-candidate', async (payload) => {
      // payload: { from, to, candidate }
      try {
        if (payload.to !== username) return;
        if (pc) await pc.addIceCandidate(new RTCIceCandidate(payload.candidate));
      } catch (err) {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞:", err);
      }
    });

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ UI
    function addMessage(msg) {
      const li = document.createElement('li');
      if (msg.from === username) li.classList.add('my');

      const peer = msg.from === username ? msg.to : msg.from;
      const title = `${peer} ‚Äî ${msg.from === username ? '—è ‚Üí ' + msg.to : msg.from}`;

      const meta = `<div class="meta">${escapeHtml(title)} ¬∑ ${escapeHtml(msg.time || '')}</div>`;

      if (msg.type === 'image') {
        li.innerHTML = meta + `<div><img src="${msg.data}" style="max-width:220px; border-radius:8px;" /></div>`;
      } else {
        li.innerHTML = meta + `<div>${escapeHtml(msg.text || '')}</div>`;
      }

      messagesUL.appendChild(li);
      messagesUL.scrollTop = messagesUL.scrollHeight;
    }

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    sendBtn.onclick = () => {
      const text = input.value.trim();
      const to = userSelect.value;
      if (!to) return alert("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è.");
      if (!text) return;
      const msg = { from: username, to, text };
      socket.emit('chat message', msg);
      input.value = '';
    };

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏
    imageInput.onchange = () => {
      const file = imageInput.files[0];
      if (!file) return;
      const to = userSelect.value;
      if (!to) return alert("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è.");
      const reader = new FileReader();
      reader.onload = () => {
        socket.emit('chat image', { from: username, to, data: reader.result });
      };
      reader.readAsDataURL(file);
      imageInput.value = '';
    };

    // Emoji
    emojiButtons.forEach(btn => {
      btn.onclick = () => {
        const to = userSelect.value;
        if (!to) return alert("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è.");
        socket.emit('chat message', { from: username, to, text: btn.textContent });
      };
    });

    // –û—á–∏—Å—Ç–∫–∞ UI –∏—Å—Ç–æ—Ä–∏–∏ (–ª–æ–∫–∞–ª—å–Ω–æ)
    clearChat.onclick = () => {
      messagesUL.innerHTML = '';
      socket.emit('chat-cleared'); // —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç? –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ
    };

    // –í–∏–¥–µ–æ—á–∞—Ç UI
    openVideoChat.onclick = () => {
      videoChat.style.display = 'flex';
    };

    startVideo.onclick = async () => {
      const to = userSelect.value;
      if (!to) return alert("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è.");

      try {
        inCall = true;
        // —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥—Ä—É–≥–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É
        socket.emit('audio-join', { to, from: username });

        localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
        localVideo.srcObject = localStream;

        pc = await createPeerConnection(to);

        localStream.getTracks().forEach(track => pc.addTrack(track, localStream));

        const offer = await pc.createOffer();
        await pc.setLocalDescription(offer);

        // –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ñ—Ñ–µ—Ä (—Å–µ—Ä–≤–µ—Ä –¥–æ–±–∞–≤–∏—Ç from)
        socket.emit('webrtc-offer', { to, offer });

        videoEnabled = true; audioEnabled = true;
        toggleVideo.textContent = "–í—ã–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É";
        toggleAudio.textContent = "–í—ã–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω";

        videoChat.style.display = 'flex';
      } catch (err) {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –≤–∏–¥–µ–æ:", err);
        alert("–ù–µ —É–¥–∞–ª–æ—Å—å –≤–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É/–º–∏–∫—Ä–æ—Ñ–æ–Ω: " + (err.message || err));
      }
    };

    stopVideo.onclick = () => {
      inCall = false;
      if (localStream) {
        localStream.getTracks().forEach(t => t.stop());
        localStream = null;
      }
      if (pc) {
        pc.close();
        pc = null;
      }
      remoteVideo.srcObject = null;
      localVideo.srcObject = null;
      videoChat.style.display = 'none';
      videoEnabled = true; audioEnabled = true;
      toggleVideo.textContent = "–í—ã–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É";
      toggleAudio.textContent = "–í—ã–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω";
    };

    toggleVideo.onclick = () => {
      if (!localStream) return;
      videoEnabled = !videoEnabled;
      localStream.getVideoTracks().forEach(t => t.enabled = videoEnabled);
      toggleVideo.textContent = videoEnabled ? "–í—ã–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É" : "–í–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É";
    };

    toggleAudio.onclick = () => {
      if (!localStream) return;
      audioEnabled = !audioEnabled;
      localStream.getAudioTracks().forEach(t => t.enabled = audioEnabled);
      toggleAudio.textContent = audioEnabled ? "–í—ã–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω" : "–í–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω";
    };

    // –°–æ–∑–¥–∞–Ω–∏–µ RTCPeerConnection
    async function createPeerConnection(remoteName) {
      if (!iceServers) {
        socket.emit('request-ice');
        iceServers = await new Promise(resolve => socket.once('ice-servers', resolve));
      }

      const pcLocal = new RTCPeerConnection({ iceServers });

      pcLocal.ontrack = e => {
        remoteVideo.srcObject = e.streams[0];
      };

      pcLocal.onicecandidate = e => {
        if (e.candidate) {
          socket.emit('webrtc-candidate', { to: remoteName, candidate: e.candidate });
        }
      };

      return pcLocal;
    }

    // –•–µ–ª–ø–µ—Ä ‚Äî –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å–µ–ª–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ–º–µ—Ç–∏—Ç—å –æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω
    function populateUsers(usersList, onlineList) {
      const prev = userSelect.value;
      userSelect.innerHTML = '<option value="">-- –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è --</option>';

      usersList.forEach(u => {
        const opt = document.createElement('option');
        const isOnline = Array.isArray(onlineList) && onlineList.includes(u);
        opt.value = u;
        opt.textContent = (isOnline ? 'üü¢ ' : '‚ö´ ') + u;
        userSelect.appendChild(opt);
      });

      if (prev && Array.from(userSelect.options).some(o => o.value === prev)) {
        userSelect.value = prev;
      }
    }

    // escape html
    function escapeHtml(s='') {
      return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]));
    }

    // –ü—Ä–æ—Å–∏–º —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏—Å–ª–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã ‚Äî –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ,
    // —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏—à–ª—ë—Ç active-users –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
    // socket.emit('get-active'); // –Ω–µ –Ω—É–∂–µ–Ω, —Å–µ—Ä–≤–µ—Ä —Å–∞–º —ç–º–∏—Ç–∏—Ç

  </script>
</body>
</html>
